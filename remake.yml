sources:
  - R/

packages:
  ## data I/O
  - readxl
  - readr
  - feather
  - RSQLite
  - storr
  - tibble
  ## geospatial tools
  - raster
  - sp
  - maptools
  - maps
  - geojsonio
  - lawn
  ## data manipulation
  - dplyr
  - dbplyr
  - tidyr
  - lubridate
  - purrr
  - lazyeval
  ## data visualization
  - grid
  - ggplot2
  - cowplot
  - viridis
  - scales
  - hrbrthemes
  - UpSetR
  - ggthemes
  ## APIs
  - bold
  - worrms
  - ridigbio
  - marmap
  - robis
  - rgbif
  - ritis
  ## other utils
  - parallel
  - assertthat
  - extrafont
  - rmarkdown
  - bookdown
  - labmanager
  - progress
  - splines


targets:

  all:
    depends:
      - manuscript.pdf
      - manuscript.docx
      - data_validation

  data_validation:
    depends:
      - data-validation/map_kozloff_idigbio.pdf
      - validate_idigbio_records
      - validate_obis_records
      ## FIXME - validate_combined_records

### WoRMS stats

  worms_stats:
    command: read_worms_stats("data-raw/20170808_worms_stats.csv")

### Kozloff species list--------------------------------------------------------

  kozloff_species_raw:
    command: get_kozloff_species("data-raw/Kozloff/GP_kozloff_edits.csv")

  kozloff_worms:
    command: add_worms(kozloff_species_raw)

  kozloff_iucn:
    command: add_iucn_status(kozloff_worms)

  kozloff_bold:
    command: find_bold_records(kozloff_worms, I("worms_valid_name"))

  ## iDigbio -------------------------------------------------------------------
  kozloff_idigbio_raw:
    command: fetch_spp_from_idigbio(kozloff_worms)

  kozloff_idigbio:
    command: filter_raw_records(kozloff_idigbio_raw)

  kozloff_idigbio_in_us:
    command: is_within_eez_records(kozloff_idigbio, map_usa)

  kozloff_idigbio_in_pnw:
    command: is_within_pnw_records(kozloff_idigbio_in_us, map_pnw)

  kozloff_spp_records_idigbio:
    command: get_n_records_in_db(kozloff_worms, kozloff_idigbio_in_pnw, field_name=I("n_idigbio"), region=I("pnw"))

  data-validation/map_kozloff_idigbio.pdf:
    command: map_kozloff(kozloff_idigbio_in_us)
    plot: true

  ## OBIS ----------------------------------------------------------------------
  data/kozloff_obis.feather:
    command: fetch_spp_from_obis(kozloff_worms, "data/kozloff_obis.feather")

  kozloff_obis:
    command: filter_raw_records("data/kozloff_obis.feather")

  kozloff_obis_in_us:
    command: is_within_eez_records(kozloff_obis, map_usa)

  kozloff_obis_in_pnw:
    command: is_within_pnw_records(kozloff_obis_in_us, map_pnw)

  kozloff_spp_records_obis:
    command: get_n_records_in_db(kozloff_worms, kozloff_obis_in_pnw, field_name=I("n_obis"), region=I("pnw"))

  ## GBIF ----------------------------------------------------------------------
  data/kozloff_gbif.feather:
    command: fetch_spp_from_gbif(kozloff_worms, feather_path="data/kozloff_gbif.feather")

  kozloff_gbif:
    command: filter_raw_records("data/kozloff_gbif.feather")

  kozloff_gbif_in_us:
    command: is_within_eez_records(kozloff_gbif, map_usa)

  kozloff_gbif_in_pnw:
    command: is_within_pnw_records(kozloff_gbif_in_us, map_pnw)

  kozloff_spp_records_gbif:
    command: get_n_records_in_db(kozloff_worms, kozloff_gbif_in_pnw, field_name=I("n_gbif"), region=I("pnw"))

  ## overlap with iDigBio query made by geography
  figures/map_kozloff_idigbio.pdf:
    command: map_kozloff(kozloff_idigbio)
    plot:
      height: 8
      width: 12

  ## figures -------------------------------------------------------------------
  figures/kozloff_not_in_idigbio.pdf:
    command: plot_spp_not_in_idigbio(kozloff_spp_records_idigbio)
    plot: true


### Gulf of Mexico species list ------------------------------------------------

  gom_species_raw:
    command: get_gom_species()

  gom_phyla:
    command: list_gom_phyla(gom_species_raw)

  gom_worms:
    command: add_worms(gom_species_raw)

  gom_iucn:
    command: add_iucn_status(gom_worms)

  gom_bold:
    command: find_bold_records(gom_worms, I("worms_valid_name"))

  ## iDigBio -------------------------------------------------------------------
  gom_idigbio_raw:
    command: fetch_spp_from_idigbio(gom_worms)

  gom_idigbio:
    command: filter_raw_records(gom_idigbio_raw)

  gom_idigbio_in_us:
    command: is_within_eez_records(gom_idigbio, map_usa)

  gom_idigbio_in_gom:
    command: is_within_gom_records(gom_idigbio_in_us, map_gom)

  gom_spp_records_idigbio:
    command: get_n_records_in_db(gom_worms, gom_idigbio_in_gom, field_name=I("n_idigbio"), region=I("gom"))

  ## OBIS ----------------------------------------------------------------------
  data/gom_obis.feather:
    command: fetch_spp_from_obis(gom_worms, "data/gom_obis.feather")

  gom_obis:
    command: filter_raw_records("data/gom_obis.feather")

  gom_obis_in_us:
    command: is_within_eez_records(gom_obis, map_usa)

  gom_obis_in_gom:
    command: is_within_gom_records(gom_obis_in_us, map_gom)

  gom_spp_records_obis:
    command: get_n_records_in_db(gom_worms, gom_obis_in_gom, field_name=I("n_obis"), region=I("gom"))

  ## GBIF ----------------------------------------------------------------------
  data/gom_gbif.feather:
    command: fetch_spp_from_gbif(gom_worms, feather_path="data/gom_gbif.feather")

  gom_gbif:
    command: filter_raw_records("data/gom_gbif.feather")

  gom_gbif_in_us:
    command: is_within_eez_records(gom_gbif, map_usa)

  gom_gbif_in_gom:
    command: is_within_gom_records(gom_gbif_in_us, map_gom)

  gom_spp_records_gbif:
    command: get_n_records_in_db(gom_worms, gom_gbif_in_gom, field_name=I("n_gbif"), region=I("gom"))

  ## figures -------------------------------------------------------------------
  figures/gom_not_in_idigbio.pdf:
    command: plot_spp_not_in_idigbio(gom_spp_records_idigbio)
    plot: true

  figures/combined_not_in_idigbio.pdf:
    command: plot_spp_not_in_idigbio_combined(kozloff_spp_records_idigbio, gom_spp_records_idigbio)
    plot:
      height: 8
      width: 12

### American mammals  ----------------------------------------------------------

  data/idigbio_mammals.feather:
    command: convert_to_feather("data-raw/vertebrates/idigbio_mammals_occurrence_raw.csv", feather_out="data/idigbio_mammals.feather")

  mammals_species_idigbio:
    command: read_idigbio_mammals("data/idigbio_mammals.feather")

  mammals_bold_idigbio:
    command: find_bold_records(mammals_species_idigbio, I("cleaned_scientificname"))

  ## species list of mammals from the American Society of Mammologists
  ## (http://www.mammalsociety.org/mammals-list)
  ## downloaded on 2017-02-15
  mammals_species_asm:
    command: read_asm_mammals("data-raw/vertebrates/mammals_species_usa.csv")

  mammals_asm_idigbio_raw:
    command: asm_mammals_idigbio(mammals_species_asm)

  mammals_asm_idigbio:
    command: asm_mammals_idigbio_summary(mammals_species_asm, mammals_asm_idigbio_raw)

  mammals_asm_bold:
    ## this produces messages about not finding a valid WoRMS ID, but it's OK here as
    ## it happens as we are trying to look for synonyms in case there is no match
    command: find_bold_mammals(mammals_species_asm, I("cleaned_scientificname"))

  mammals_asm_summary:
    command: make_idig_bold_summary(mammals_asm_idigbio, mammals_asm_bold)

  ### American Amphibians ----------------------------------------------------

  amphibian_species:
    command: list_us_amphibians()

  amphibian_idigbio:
    command: fetch_counts_idigbio(amphibian_species)

  amphibian_bold:
    command: fetch_vert_bold(amphibian_species)

  amphibian_summary:
    command: make_idig_bold_summary(amphibian_idigbio, amphibian_bold)

  ### American Birds -----------------------------------------------------------

  bird_species:
    command: list_us_birds(file="data-raw/vertebrates/NACC_list_species_birds.csv")

  bird_idigbio:
    command: fetch_counts_idigbio(bird_species)

  bird_bold:
    command: fetch_vert_bold(bird_species)

  bird_summary:
    command: make_idig_bold_summary(bird_idigbio, bird_bold)

### get species list from the US using iDigBio ---------------------------------

  map_usa:
    command: get_map_usa("data-raw/USA-EEZ/eez.shp")

  coords_idigbio_usa:
    command: get_coords_idigbio_query(map_usa)

  ## iDigBio -------------------------------------------------------------------
  idigbio_database:
    command: create_records_db(coords_idigbio_usa, db_table=I("us_idigbio"), gom_phyla=gom_phyla)

  idigbio_records_all:
    command: extract_inverts_from_db(db_table=I("us_idigbio"), gom_phyla)
    depends: idigbio_database

  idigbio_records:
    command: filter_records_by_geo(idigbio_records_all, map_usa)

  idigbio_iucn:
    command: add_iucn_status(idigbio_records)

  idigbio_bold:
    command: find_bold_records(idigbio_records, I("worms_valid_name"))

  ## OBIS ----------------------------------------------------------------------
  obis_database:
    command: create_obis_db(coords_idigbio_usa, db_table=I("us_obis"), gom_phyla=gom_phyla)

  obis_records_all:
    command: extract_inverts_from_db(db_table=I("us_obis"), gom_phyla)
    depends: obis_database

  obis_records:
    command: filter_records_by_geo(obis_records_all, map_usa)

  ## Gulf of Mexico ------------------------------------------------------------

  map_gom:
    command: get_felder_map_gom("data-raw/mregions_gulf_of_mexico_shp/iho.shp")

  coords_gom_query:
    command: get_coords_idigbio_query(map_gom, cellsize=I(.2))

  idigbio_gom_database:
    command: create_records_db(coords_gom_query, db_table=I("gom_idigbio"), gom_phyla=gom_phyla)

  idigbio_gom_records_all:
    command: extract_inverts_from_db(db_table=I("gom_idigbio"), gom_phyla)
    depends: idigbio_gom_database

  idigbio_gom_records:
    command: filter_records_by_geo(idigbio_gom_records_all, map_gom)

  obis_gom_records_raw:
    command: fill_store_obis_by_geo(map_gom, gom_phyla=gom_phyla)

  obis_gom_records:
    command: add_worms(obis_gom_records_raw)

  combined_gom_records:
    command: combine_idigbio_obis(idigbio_gom_records, obis_gom_records)

  total_gom_species:
    command: combine_species_list(idigbio = idigbio_gom_records, obis = obis_gom_records, checklist = gom_worms)

  total_gom_records:
    command: combine_records(idigbio=idigbio_gom_records, obis=obis_gom_records, checklist=gom_worms, map=map_gom)

  data/gom_compare_database_coverage.csv:
    command: generate_upsetr_csv(list = gom_worms, idigbio = idigbio_gom_records, obis = obis_gom_records, file="data/gom_compare_database_coverage.csv")

  figures/gom_database_coverage.pdf:
    command: plot_upsetr("data/gom_compare_database_coverage.csv")
    plot:
      width:  4.5
      height: 4.5

  ## Pacific Northwest ---------------------------------------------------------

  map_pnw:
    command: get_map_pnw()

  coords_pnw_query:
    command: get_coords_idigbio_query(map_pnw, cellsize=I(.5))

  idigbio_pnw_database:
    command: create_records_db(coords_pnw_query, db_table=I("kozloff_idigbio"))

  idigbio_pnw_records_all:
    command: extract_inverts_from_db(db_table=I("kozloff_idigbio"), gom_phyla)
    depends: idigbio_pnw_database

  idigbio_pnw_records:
    command: filter_records_by_geo(idigbio_pnw_records_all, map_pnw)

  obis_pnw_records_raw:
    command: fill_store_obis_by_geo(map_pnw, gom_phyla=gom_phyla)

  obis_pnw_records:
    command: add_worms(obis_pnw_records_raw)

  combined_pnw_records:
    command: combine_records(idigbio_pnw_records, obis_pnw_records, map = map_gom) # note: map_gom isn't a mistake, we use it to assign records to GOM as a region, but probably not in use here.

  total_pnw_species:
    command: combine_species_list(idigio = idigbio_pnw_records, obis = obis_pnw_records, checklist = kozloff_worms)

  total_pnw_records:
      command: combine_records(idigbio=idigbio_pnw_records, obis=obis_pnw_records, checklist=kozloff_worms, map = map_gom)

  data/kozloff_compare_database_coverage.csv:
    command: generate_upsetr_csv(list = kozloff_worms, idigbio = idigbio_pnw_records, obis = obis_pnw_records, file = "data/kozloff_compare_database_coverage.csv")

  figures/kozloff_database_coverage.pdf:
    command: plot_upsetr("data/kozloff_compare_database_coverage.csv")
    plot:
      width:  4.5
      height: 4.5

  ## Synthesis -----------------------------------------------------------------

  combined_regional_species_list:
    command: combined_regional_by_geo(gom_worms, idigbio_gom_records, obis_gom_records, kozloff_worms, idigbio_pnw_records, obis_pnw_records)

  figures/database_coverage.pdf:
    command: combine_plots("figures/gom_database_coverage.pdf", "figures/kozloff_database_coverage.pdf", output="figures/database_coverage.pdf")

  species_in_common:
    command: get_species_in_common(gom_worms, idigbio_gom_records, obis_gom_records, kozloff_worms, idigbio_pnw_records, obis_pnw_records)

  database_overlap:
    command: compare_database_overlap(gom_worms, kozloff_worms, idigbio_gom_records, obis_gom_records, idigbio_pnw_records, obis_pnw_records)

  figures/database_overlap.pdf:
    command: plot_database_overlap(database_overlap)
    plot:
      width: 12
      height: 4

  figures/database_overlap_percent.pdf:
    command: plot_database_overlap_percent(database_overlap, combined_regional_species_list)
    plot:
      width: 9
      height: 3.7

  idigbio_invert_summary:
    command: plot_idigbio_invert_summary(idigbio_records, idigbio_bold)

  idigbio_identification_level_through_time:
    command: data_identification_level_through_time(idigbio_records)

  figures/idigbio_identification_level_through_time.pdf:
    command: plot_identification_level_through_time(idigbio_identification_level_through_time)
    plot:
      width: 8
      height: 5

  #us_list_species:
  #  command: combine_species_list

### summary tables
  # table_idigbio_species_sequenced:
  #   command: make_table_bold_records_per_idigbio_species(global=global_idigbio_species_with_bold_info, east_coast=east_idigbio_species_with_bold_info, west_coast=west_idigbio_species_with_bold_info, florida=florida_idigbio_species_with_bold_info)

  # figures/plot_idigbio_species_sequenced.pdf:
  #   command: make_plot_bold_records_per_idigbio_species(table_idigbio_species_sequenced)
  #   plot: true

  # idigbio_species_list_dates:
  #   command: assemble_idigbio_species_list_dates(global_idigbio_species_with_worms_info)
  #   depends: idigbio_records

  # figures/plot_idigbio_species_dates.pdf:
  #   command: make_plot_idigbio_records_per_date(idigbio_species_list_dates)
  #   plot:
  #     width: 12
  #     height: 8

  barcode_status_data:
    command: bold_status_data(total_gom_species, total_pnw_species, combined_species)

  figures/proportion_barcoded.pdf:
    command: plot_bold_status(barcode_status_data)
    plot: true

  #table_records_per_species:
  #   command: make_table_records_per_species()
  #   depends: bold_records_for_idigbio_species

### Maps diversity + samples ---------------------------------------------------

  ## iDigBio
  idigbio_data_map_samples:
    command: data_map_samples(idigbio_records)

  idigbio_data_map_diversity:
    command: data_map_diversity(idigbio_records)

  idigbio_map_samples:
    command: make_heatmap(idigbio_data_map_samples, I("iDigbio -- Number of samples"))

  idigbio_map_diversity:
    command: make_heatmap(idigbio_data_map_diversity, I("iDigBio -- Number of species"))

  ## OBIS
  obis_map_samples_data:
    command: data_map_samples(obis_records)

  obis_map_diversity_data:
    command: data_map_diversity(obis_records)

  obis_map_samples:
    command: make_heatmap(obis_map_samples_data, I("OBIS -- Number of samples"))

  obis_map_diversity:
    command: make_heatmap(obis_map_diversity_data, I("OBIS -- Number of species"))

  ## Combined OBIS + iDigBio
  combined_records:
    command: combine_records(idigbio_records, obis_records, map = map_gom)

  combined_species:
    command: combine_species_list(idigbio = idigbio_records, obis = obis_records)

  combined_data_map_samples:
    command: data_map_samples(combined_records)

  combined_data_map_diversity:
    command: data_map_diversity(combined_records)

  combined_data_map_standardized_diversity:
    command: data_map_standardized_diversity(combined_data_map_samples, combined_data_map_diversity)

  combined_map_samples:
    command: make_heatmap(combined_data_map_samples, I("Number of samples"))

  combined_map_diversity:
    command: make_heatmap(combined_data_map_diversity, I("Number of species"))

  figures/combined_gradient.pdf:
    command: plot_gradient(combined_records)
    plot:
      width: 8.5
      height: 3.5

  ## map plots -----------------------------------------------------------------
  figures/idigbio_map_sampling.pdf:
    command: combine_cowplots(idigbio_map_samples, idigbio_map_diversity, nrow=I(2), common_legend=I(FALSE))
    plot:
      width: 6
      height: 7

  figures/obis_map_sampling.pdf:
    command: combine_cowplots(obis_map_samples, obis_map_diversity, nrow=I(2), common_legend=I(FALSE))
    plot:
      width: 6
      height: 7

  figures/combined_map_sampling.pdf:
    command: combine_cowplots(combined_map_samples, combined_map_diversity, nrow=I(2), common_legend=I(FALSE))
    plot:
      width: 6
      height: 7

### plot summary database ------------------------------------------------------

  summary_richness_per_db_gom:
    command: summarize_richness_per_db(gom_bold, gom_spp_records_idigbio, gom_spp_records_obis, gom_spp_records_gbif, region=I("gom"))

  summary_richness_per_db_koz:
    command: summarize_richness_per_db(kozloff_bold, kozloff_spp_records_idigbio, kozloff_spp_records_obis, kozloff_spp_records_gbif, region=I("pnw"))

  plot_richness_per_db_koz:
    command: plot_richness_per_db(summary_richness_per_db_koz, region=I("pnw"))

  plot_richness_per_db_gom:
    command: plot_richness_per_db(summary_richness_per_db_gom, region=I("gom"))

  figures/richness_per_db.pdf:
    command: combine_cowplots(plot_richness_per_db_gom, plot_richness_per_db_koz)
    plot:
      width: 9
      height: 9.5

### plot sampling effort (correlation between number of samples vs number species

  figures/plot_sampling_effort.pdf:
    command: plot_sampling_effort(combined_data_map_standardized_diversity, map_gom)
    plot:
      height: 4.5
      width: 6.5

### BOLD data ------------------------------------------------------------------

  global_bold_stats_raw:
    command: get_bold_global_coverage_raw()

  global_bold_stats:
    command: get_bold_global_coverage(global_bold_stats_raw, worms_stats)

### in text statistics ---------------------------------------------------------

  stat_bold:
    command: make_stat_bold(gom_bold, kozloff_bold, gom_worms, kozloff_worms)

  stat_barcoding:
    command: make_stat_barcoding(barcode_status_data)

  stat_sampling_effort:
    command: calc_stat_sampling_effort(combined_data_map_standardized_diversity, map_gom)

  prop_spp_barcoded:
    command: calc_prop_spp_barcoded(combined_species)

  prop_singleton_species:
    command: calc_prop_nspecimens_species(combined_records, n_specimens=I(1))

  prop_10_specimens_species:
    command: calc_prop_nspecimens_species(combined_records, n_specimens=I(10))

  prop_30_specimens_species:
    command: calc_prop_nspecimens_species(combined_records, n_specimens=I(30))

  records_rare_phyla:
    command: calc_records_rare_phyla(idigbio_records, obis_records, worms_stats, gom_phyla)

  n_idigbio_phyla:
    command: calc_n_idigbio_phyla(idigbio_records)

  prop_species_not_collected_since_1980:
    command: calc_prop_species_not_collected_since(idigbio_records, I(1980))

  n_spp_comparison:
    command: calc_n_spp_comparison(idigbio_samples_through_time_data)

  #prop_species_not_collected_since_1990:
  #  command: calc_prop_species_not_collected_since(idigbio_species_list_dates, I(1990))

  recently_collected:
    command: not_in_list_collected_recently(database_overlap, map_gom, map_pnw)

  not_really_in_database:
    command: get_not_really_in_database(database_overlap, map_usa)

### Attributions ---------------------------------------------------------------

  # idigbio_records_attributions:
  #   command: idigbio_attribution(idigbio_records)

  # idigbio_gom_records_attributions:
  #   command: idigbio_attribution(idigbio_gom_records)

  # idigbio_pnw_records_attributions:
  #   command: idigbio_attribution(idigbio_pnw_records)

### Samples and species collected through time ---------------------------------

  ## iDigBio
  idigbio_samples_through_time_data:
    command: make_knowledge_through_time(idigbio_records)

  idigbio_samples_through_time:
    command: plot_cum_samples_through_time(idigbio_samples_through_time_data, facet=I(FALSE))

  idigbio_species_through_time:
    command: plot_cum_spp_through_time(idigbio_samples_through_time_data, facet=I(FALSE))

  idigbio_effort_through_time:
    command: plot_samples_vs_spp_through_time(idigbio_samples_through_time_data)

  figures/idigbio_through_time.pdf:
    command: combine_cowplots_2(idigbio_samples_through_time, idigbio_species_through_time, idigbio_effort_through_time)
    plot:
      width:  8
      height: 8

  ## OBIS
  obis_samples_through_time_data:
    command: make_knowledge_through_time(obis_records)

  obis_samples_through_time:
    command: plot_cum_samples_through_time(obis_samples_through_time_data, facet=I(FALSE))

  obis_species_through_time:
    command: plot_cum_spp_through_time(obis_samples_through_time_data, facet=I(FALSE))

  obis_effort_through_time:
    command: plot_samples_vs_spp_through_time(obis_samples_through_time_data)

  figures/obis_through_time.pdf:
    command: combine_cowplots_2(obis_samples_through_time, obis_species_through_time, obis_effort_through_time)
    plot:
      width:  8
      height: 8

  ## combined
  combined_samples_through_time_data:
    command: make_knowledge_through_time(combined_records)

  combined_samples_through_time:
    command: plot_cum_samples_through_time(combined_samples_through_time_data, facet=I(FALSE))

  combined_species_through_time:
    command: plot_cum_spp_through_time(combined_samples_through_time_data, facet=I(FALSE))

  combined_effort_through_time:
    command: plot_samples_vs_spp_through_time(combined_samples_through_time_data)

  figures/combined_through_time.pdf:
    command: combine_cowplots_2(combined_samples_through_time, combined_species_through_time, combined_effort_through_time)
    plot:
      width:  8
      height: 8

### Data validation ------------------------------------------------------------

  validate_idigbio_records:
    command: validate_records(idigbio_records, gom_phyla)

  validate_obis_records:
    command: validate_records(obis_records, gom_phyla)

  ## FIXME
  #validate_combined_records:
  #  command: validate_records(combined_records, gom_phyla)


### Manuscript -----------------------------------------------------------------

  manuscript.md:
    depends:
      - idigbio_records
      - obis_records
      - idigbio_gom_records
      - obis_gom_records
      - idigbio_pnw_records
      - obis_pnw_records
      - combined_gom_records
      - combined_pnw_records
      - total_gom_records
      - total_pnw_records
      - combined_records
      - combined_species
      - gom_worms
      - kozloff_worms
      - mammals_species_asm
      - amphibian_summary
      - stat_bold
      - stat_barcoding
      - barcode_status_data
      - stat_sampling_effort
      - prop_singleton_species
      - prop_10_specimens_species
      - prop_30_specimens_species
      - n_idigbio_phyla
      - records_rare_phyla
      - prop_species_not_collected_since_1980
      - n_spp_comparison
      - species_in_common
      - summary_richness_per_db_gom
      - summary_richness_per_db_koz
      - recently_collected
      - not_really_in_database
      - prop_spp_barcoded
      ## figures
      - figures/combined_map_sampling.pdf
      - figures/combined_gradient.pdf
      - figures/idigbio_map_sampling.pdf
      - figures/obis_map_sampling.pdf
      - figures/plot_sampling_effort.pdf
      - figures/proportion_barcoded.pdf
      - figures/richness_per_db.pdf
      - figures/database_coverage.pdf
      - figures/database_overlap.pdf # not in use
      - figures/database_overlap_percent.pdf
      - figures/idigbio_through_time.pdf
      - figures/obis_through_time.pdf
      - figures/combined_through_time.pdf
      - figures/idigbio_identification_level_through_time.pdf
      ## attributions
      #- idigbio_records_attributions
      #- idigbio_gom_records_attributions
      #- idigbio_pnw_records_attributions
    knitr: true

  manuscript.pdf:
    command: render("manuscript.md")

  manuscript.docx:
    command: render("manuscript.md", output_format=I("bookdown::word_document2"))
